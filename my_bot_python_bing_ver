import os
import discord
from discord.ext import commands
import random

intents = discord.Intents.all()
bot = commands.Bot(command_prefix='!', intents=intents)

@bot.event
async def on_ready():
    print(f'{bot.user} is online!')

@bot.command()
async def hi_bot(ctx):
    """Responds with 'Hello Moshe''"""
    await ctx.send(f'Hello Moshe')

@bot.command()
async def ping(ctx):
    """Responds with the current latency of the bot"""
    await ctx.send(f'Pong! Latency: {round(bot.latency * 1000)}ms')

@bot.command()
async def flip(ctx):
    """Flips a coin and responds with either heads or tails"""
    result = random.choice(['heads', 'tails'])
    await ctx.send(f'{ctx.author.mention} flipped a coin and got {result}!')

@bot.command()
async def roll(ctx, num_sides: int = 6):
    """Rolls a dice with the specified number of sides (default 6)"""
    if num_sides < 1:
        await ctx.send("Number of sides must be greater than 0.")
    else:
        result = random.randint(1, num_sides)
        await ctx.send(f'{ctx.author.mention} rolled a {num_sides}-sided dice and got {result}!')

# Get the token from an environment variable
TOKEN = os.getenv('DISCORD_TOKEN')

# Run the bot
bot.run(TOKEN)